generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
  SUPER_ADMIN
}

model User {
  id         String  @id @default(uuid())
  name       String
  email      String  @unique
  password   String
  phone      String?
  address    String?
  profileImg String?
  role       Role    @default(USER)
  credits    Int     @default(10)
  isActive   Boolean @default(true)
  isVerified Boolean @default(false)
  isDeleted  Boolean @default(false)

  sessionAsTeacher BarterSession[] @relation("Teacher")
  sessionAsStudent BarterSession[] @relation("Learner")

  userSkills UserSkill[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Review {
  id      String  @id @default(uuid())
  rating  Int
  comment String?

  session   BarterSession @relation(fields: [sessionId], references: [id])
  sessionId String        @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum SessionStatus {
  PENDING
  ACCEPTED
  COMPLETED
  CANCELLED
}

model BarterSession {
  id          String        @id @default(uuid())
  teacher     User          @relation("Teacher", fields: [teacherId], references: [id])
  teacherId   String
  learner     User          @relation("Learner", fields: [learnerId], references: [id])
  learnerId   String
  skill       Skill         @relation(fields: [skillId], references: [id])
  skillId     String
  hours       Int
  status      SessionStatus @default(PENDING)
  scheduledAt DateTime

  review Review?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

enum SkillType {
  OFFER
  WANT
}

enum SkillLevel {
  BEGINNER
  INTERMEDIATE
  EXPERT
}

model Skill {
  id    String      @id @default(uuid())
  name  String      @unique
  users UserSkill[]

  barterSessions BarterSession[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model UserSkill {
  id      String     @id @default(uuid())
  user    User       @relation(fields: [userId], references: [id])
  userId  String
  skill   Skill      @relation(fields: [skillId], references: [id])
  skillId String
  type    SkillType
  level   SkillLevel

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
